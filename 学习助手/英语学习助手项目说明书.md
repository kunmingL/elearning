# 英语学习助手项目说明文档

## 1. 目的

本文档旨在详细说明英语学习助手项目的需求分析、系统设计和实现方案。

### 1.1 预期读者
- 项目开发团队成员
- 产品经理
- 测试人员
- 运维人员

### 1.2 术语表
| 术语 | 说明 |
|------|------|
| AI | 人工智能 |
| TTS | 文本转语音技术 |
| ASR | 自动语音识别 |
| NLP | 自然语言处理 |

### 1.3 参考资料
- 微信小程序开发文档
- Spring Boot 官方文档
- OpenAI API 文档
- 科大讯飞 API 文档
- Azure TTS API 文档

## 2. 需求分析

### 2.1 整体业务流程

#### 文字说明
1. 用户通过微信小程序进入系统
2. 选择单词听写或口语练习功能
3. 系统根据用户选择提供相应服务
4. 记录学习数据并生成分析报告

#### 时序图
```mermaid
sequenceDiagram
    participant User as 用户
    participant Mini as 小程序
    participant Java as Java后端
    participant Python as Python后端
    participant AI as AI服务

    User->>Mini: 进入小程序
    Mini->>Java: 获取用户信息
    Java-->>Mini: 返回用户数据
    
    alt 单词听写
        User->>Mini: 上传学习材料
        Mini->>Java: 转发文件
        Java->>Python: 请求AI处理
        Python->>AI: 调用AI服务
        AI-->>Python: 返回处理结果
        Python-->>Java: 返回提取数据
        Java-->>Mini: 返回单词本
        Mini-->>User: 显示学习内容
    else 口语练习
        User->>Mini: 选择场景
        Mini->>Java: 获取场景数据
        Java->>Python: 请求AI对话
        Python->>AI: 调用AI服务
        AI-->>Python: 返回对话内容
        Python-->>Java: 返回对话数据
        Java-->>Mini: 返回场景内容
        Mini-->>User: 显示对话界面
    end
```




## 2.2 主要功能模块

### 2.2.1 单词听写功能

#### 2.2.1.1 功能说明
提供用户上传学习材料、生成单词本、进行听写练习的完整功能。

#### 2.2.1.2 业务流程
1. 文件上传与处理
2. 模板选择与内容提取
3. 学习计划制定
4. 听写练习
5. 成果报告生成

#### 2.2.1.3 业务规则
- 文件大小限制：单个不超过10MB
- 批量上传限制：单次最多10个文件
- 学习量建议：每日20-50个单词
- 复习周期：按艾宾浩斯遗忘曲线设置

#### 2.2.1.4 输入要素
- 学习材料文件
- 模板选择
- 学习计划参数
- 听写答案

#### 2.2.1.5 输出要素
- 单词本内容
- 学习计划
- 听写报告
- 学习建议

### 2.2.2 口语练习功能

#### 2.2.2.1 功能说明
提供AI驱动的口语对话练习，支持多场景模拟。

#### 2.2.2.2 业务流程
1. 场景选择
2. AI对话初始化
3. 语音交互
4. 实时纠正
5. 对话记录保存

#### 2.2.2.3 业务规则
- 对话上下文保持
- 发音准确度要求
- 场景切换规则
- 历史记录保存期限

#### 2.2.2.4 输入要素
- 场景选择
- 用户语音
- 对话指令

#### 2.2.2.5 输出要素
- AI回复
- 发音评估
- 表达建议
- 练习报告

## 3. 系统设计

### 3.1 单词听写模块

#### 3.1.1 功能描述
实现单词学习全流程，包括材料上传、内容提取、听写练习等功能。

#### 3.1.2 界面设计
```ascii
+------------------------+
|     单词听写练习        |
+------------------------+
| ▶️ [播放] 🔁 [重复]    |
|                        |
| [____________] 输入框   |
|                        |
| [跳过] [提交]          |
|                        |
| 进度: 7/20            |
+------------------------+
```

#### 3.1.3 接口文档（入参/出参）
接口1.dealInputFile 文件上传接口，由javaweb检查文件格式和文件大小，绑定用户与文件关系，由pythonweb返回文件单词总数。
接口2.createUserSchedule 生成用户学习计划，根据用户选择和计划参数生成学习计划，由javaweb接收参数,由。
接口3.startDailySchedule 获取指定日期的每日学习计划，返回学习计划内容。

#### 3.1.5 算法/设计方法
- 文本提取算法
- 艾宾浩斯遗忘曲线
- 学习进度计算
- 正确率评估

#### 3.1.6 流程逻辑
```mermaid
graph TD
    A[开始] --> B[上传文件]
    B --> C[选择模板]
    C --> D[AI内容提取]
    D --> E[生成单词本]
    E --> F[设置学习计划]
    F --> G[开始听写]
    G --> H{判断答案}
    H -->|正确| I[下一个]
    H -->|错误| J[记录错误]
    I --> K{是否完成}
    J --> K
    K -->|否| G
    K -->|是| L[生成报告]
    L --> M[结束]
```


### 3.2 口语练习模块

#### 3.2.1 功能描述
提供AI驱动的口语对话练习功能，支持场景模拟和实时反馈。

#### 3.2.2 界面设计
```ascii
+------------------------+
|      口语练习          |
+------------------------+
| 场景：咖啡厅点餐        |
|                        |
| AI: May I take your   |
|     order?            |
|                        |
| [🎤] 开始说话          |
| [📝] 查看建议          |
+------------------------+
```

#### 3.2.3 接口文档（入参/出参）



#### 3.2.5 算法/设计方法
- 语音识别算法
- 自然语言处理
- 发音评估
- 对话管理

#### 3.2.6 流程逻辑
```mermaid
graph TD
    A[开始] --> B[选择场景]
    B --> C[初始化AI]
    C --> D[等待输入]
    D --> E{输入类型}
    E -->|语音| F[语音识别]
    E -->|文本| G[文本处理]
    F --> H[AI处理]
    G --> H
    H --> I[生成回复]
    I --> J[TTS播放]
    J --> K{继续对话}
    K -->|是| D
    K -->|否| L[保存记录]
    L --> M[结束]
```

## 3. 系统实现细节

### 3.1 英语对话模块

#### 3.1.1 核心功能
- AI驱动的英语对话
- 上下文对话管理
- 语音合成
- 对话历史记录

#### 3.1.2 实现流程
1. 对话初始化
   - 创建新对话或加载已有对话
   - 构建对话上下文
   
2. AI交互
   - 调用AI服务生成回复
   - 保存对话历史
   
3. 语音合成
   - 生成语音文件
   - 返回音频和文本

### 3.2 文件处理模块

#### 3.2.1 核心功能
- 文件验证和存储
- 单词提取
- 学习计划初始化

#### 3.2.2 实现流程
1. 文件验证
   - 检查文件格式(支持pdf/doc/docx等)
   - 验证文件大小(限制10MB)
   
2. 文件处理
   - 保存文件
   - 创建文档记录
   
3. 单词提取
   - 调用AI服务分析文件
   - 提取单词总数
   - 更新学习计划

### 3.3 学习计划模块

#### 3.3.1 核心功能
- 学习计划生成
- 每日单词分配
- 学习进度管理

#### 3.3.2 实现流程
1. 计划生成
   - 验证学习参数
   - 计算学习周期
   - 生成每日计划
   
2. 单词分配
   - AI分析单词难度
   - 合理分配每日单词
   - 创建单词列表

3. 进度管理
   - 记录学习进度
   - 更新完成状态
   - 生成学习报告

### 3.4 数据存储设计

#### 3.4.1 核心表结构
- 用户表(t_user)
- 文档表(t_document)
- 学习计划表(t_study_plan)
- 单词表(t_word)
- 每日学习表(t_daily_study)
- 对话表(t_conversation)
- 对话历史表(t_conversation_history)

#### 3.4.2 关键字段说明
- 状态字段使用tinyint类型
- 创建/更新时间自动维护
- 关键字段建立索引
- 使用varchar(32)存储ID

### 3.5 异常处理机制

#### 3.5.1 异常分类
- 业务异常(BusinessException)
- 系统异常(SystemException)
- 参数异常(IllegalArgumentException)

#### 3.5.2 处理策略
- 统一异常处理
- 详细错误日志
- 友好错误提示
- 事务回滚机制

### 3.6 接口安全性

#### 3.6.1 安全措施
- 参数验证
- 文件类型限制
- 大小限制
- 用户认证

#### 3.6.2 性能优化
- 异步处理
- 缓存机制
- 批量处理
- 索引优化